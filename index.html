<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="katChimes.css">
    <title>Wind Chime Calculator</title>
</head>

<body>

    <div class="header">
        <header class="flowers">
            <img class="chime-gif" src="./windchime.gif" />
            <img class="flower-gif" src="./abeja.gif" />
            <img class="chime-gif" src="./windchime.gif" />
            <img class="flower-gif" src="./abeja.gif" />
            <img class="chime-gif" src="./windchime.gif" />
            <p style="text-align: center;">Chime Calculator</p>
            <img class="chime-gif" src="./windchime.gif" />
            <img class="flower-gif" src="./abeja.gif" />
            <img class="chime-gif" src="./windchime.gif" />
            <img class="flower-gif" src="./abeja.gif" />
            <img class="chime-gif" src="./windchime.gif" />
        </header>
        <nav class="navbar">

            <a href="#tuning">Calculator</a>
            |
            <a href="#howto">How-To</a>
            |
            <a href="#about">About</a>
            |
            <a href="./feedback.html">Feedback</a>
        </nav>
    </div>
    <div class="main">
        <div class="calc-inputs">
            <form id="tuning" class="scale-input">
                <label class="label" for="scale">Scale or Chord:</label>
                <select class="dropdown input" name="scale" id="scale">
                    <option value="major pentatonic">major pentatonic</option>
                    <option value="minor pentatonic">minor pentatonic</option>
                    <option value="major scale">major scale</option>
                    <option value="harmonic minor scale">harmonic minor scale</option>
                    <option value="natural minor scale">natural minor scale</option>
                    <option value="ukrainian dorian">ukrainian dorian</option>
                </select>
            </form>
            <form class="length-input" id="length">
                <label class="label">Longest Chime Length: </label><input class="input length-input" type="number"
                    name="fname" value="12" step=".0001">
            </form>
        </div>



        <br>
        <button class="submit-button" onclick="getLengths()">Get Chime lengths</button>
        <div class="lengths">
            <p id="demo"></p>
        </div>
        <div id="howto" class="howto">
            <h1>How-To</h1>
            <ol class="small">
                <li>Cut pipe to the lengths the calculator gives</li>
                <li>Drill a hole 22.4% from the top where it will hang from (personally, I do this by ear without
                    measure, just hold the chime between your thumb and index and strike the chime. Adjust your finger
                    placement until the chime sounds the best.</li>
                <li>String the chimes however you like. <a href="https://youtu.be/_pBb20Gb3HY?t=96">Here’s a cool way to
                        do it</a>
                </li>
                <li>You’ll something at the top to string them through (usually a round piece of wood)</li>

                <li>Hang something from the center to strike the chimes (sounds best usually if it strikes the chimes in
                    their centers)</li>
                <li>A lot of chimes have something hanging on the same string as the striker in the center to make the
                    striker move more</li>
                <li>Decorate if you’d like!</li>
            </ol>
        </div>
        <div id="about" class="about">
            <h1>About</h1>
            <p class="small">
                This wind chime calculator will give you the lengths to cut pipes to get the desired notes.<br><br>

                I wanted to keep the calculator simple for now, so there are many features which might be useful that
                are not included, like different diameters and materials, cost, specific notes or frequencies.<br><br>

                Right now all you do is input the length of your lowest note (longest chime) and what scale or chord
                your want (starting with that lowest note). I am a musician and wanted to make a more musically oriented
                tool, so you will find many options for scale and chord.
                <br><br>
                The math behind this calculator is from <a href="https://pages.mtu.edu/~suits/windchime.html ">Bryan H.
                    Suits</a><br>
                Many people find <a href="https://leehite.org/Chimes.htm">Lee Hite’s wind chime guide</a> useful </p>
        </div>

    </div>
    <footer class="footer">
        <img class="banner" src="donate.gif" />
        <img class="banner" src="sst.gif" />
        <a href="https://tandy.bandcamp.com"><img class="banner" src="toot.gif" /></a>
        <div class="hit-counter">
            <p>Number of Visits</p>
            <script type="text/javascript" src="//counter.websiteout.net/js/24/0/0/0"></script>
        </div>
    </footer>

    <script>
        var lengthInput = document.getElementById("length");
        lengthInput.addEventListener("keydown", function (e) {

            if (e.code === "Enter") { //checks whether the pressed key is "Enter"
                e.preventDefault();
                getLengths();
            }
        });
    </script>

    <script>
        function getLengths() {
            const scales = {
                "ukrainian dorian": ["1", "2", "b3", "#4", "5", "6", "b7", "8"],
                "major scale": ["1", "2", "3", "4", "5", "6", "7", "8"],
                "major chord": ["1", "3", "5", "8"],
                "minor chord": ["1,b3,5,8"],
                "natural minor scale": ["1", "2", "b3", "4", "5", "b6", "b7", "8"],
                "harmonic minor scale": ["1", "2", "b3", "4", "5", "b6", "7", "8"],
                "major pentatonic": ["1", "2", "3", "5", "6", "8"],
                "minor pentatonic": ["1", "b3", "4", "5", "b7", "8"],
                "chromatic": ["1", "b2", "2", "b3", "3", "4", "#4", "5", "b6", "6", "b7", "7", "8"]
            }
            const length = Number(document.getElementById("length").elements[0].value);;
            const tuning = scales[document.getElementById("tuning").elements[0].value];
            var text = `<table>
                            <tr>
                                <th>Scale Degree</th>
                                <th>Length</th>
                            </tr>`;
            const proportions = {
                "1": 1,
                "#1": .9798,
                "b2": .9798,
                "2": .9428,
                "#2": .9129,
                "b3": .9129,
                "3": .8944,
                "4": .8660,
                "#4": .8433,
                "b5": .8433,
                "5": .8165,
                "#5": .7906,
                "b6": .7906,
                "6": .7746,
                "º7": .7746,
                "b7": .7454,
                "7": .7303,
                "8": .7071
            }

            for (let i = 0; i < tuning.length; i++) {
                text +=
                `<tr><td>${tuning[i]}</td><td>${String((length * proportions[tuning[i]]).toFixed(4))}</td></tr>`;
            }
            text += "</table>"
            document.getElementById("demo").innerHTML = text;
        }
    </script>

</body>

</html>